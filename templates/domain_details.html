{% extends "base.html" %}

{% block title %}Domain Details | Thrivemap{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/domain_details.css') }}">
{% endblock %}

{% block content %}
    <section class="domain-details">
        <h2>Domain Details</h2>
        <div class="domain-info">
            <h3>{{ domain.domain_name }}</h3>
            <!-- Add more domain details here if needed -->
        </div>
        <button onclick="window.location.href='{{ url_for("domain.home") }}'">Back to Home</button>

        <div class="columns">
            <div class="column">
                <h3>Notes</h3>
                <form action="{{ url_for('domain.add_note', domain_id=domain.domain_id) }}" method="post">
                    <textarea name="note_text" placeholder="Add a note" required></textarea>
                    <button type="submit">Add Note</button>
                </form>
                <div class="grid">
                    {% for note in notes %}
                        <div class="tile">
                            {{ note.text }}
                            <div class="note-actions">
                                <button class="edit-btn" onclick="openEditNoteModal(event, {{ note.note_id }}, '{{ note.text }}')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="confirmDeleteNote(event, {{ note.note_id }})">üóëÔ∏è</button>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

            <div class="column">
                <h3>Goals</h3>
                <form action="{{ url_for('domain.add_goal', domain_id=domain.domain_id) }}" method="post">
                    <textarea name="goal_text" placeholder="Add a goal" required></textarea>
                    <button type="submit">Add Goal</button>
                </form>
                <div class="grid">
                    {% for goal in goals %}
                        <div class="tile {% if goal.completed %}completed{% endif %}">
                            <input type="checkbox" {% if goal.completed %}checked{% endif %} onclick="toggleGoalCompletion(event, {{ goal.goal_id }}, {{ goal.completed }})">
                            {{ goal.text }}
                            <div class="goal-actions">
                                <button class="edit-btn" onclick="openEditGoalModal(event, {{ goal.goal_id }}, '{{ goal.text }}')">‚úèÔ∏è</button>
                                <button class="delete-btn" onclick="confirmDeleteGoal(event, {{ goal.goal_id }})">üóëÔ∏è</button>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmation-modal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeConfirmationModal()">&times;</span>
                <h3>Are you sure you want to mark this goal as completed?</h3>
                <button id="confirm-btn" onclick="confirmCompletion()">Yes</button>
                <button onclick="closeConfirmationModal()">No</button>
            </div>
        </div>
    </section>
{% endblock %}

{% block extra_js %}
    <script src="{{ url_for('static', filename='js/domain_details.js') }}"></script>
{% endblock %}
